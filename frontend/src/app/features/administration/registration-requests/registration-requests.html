<div class="space-y-6">
  <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
    <div>
      <h1 class="text-color text-2xl font-bold">Registration requests</h1>
      <p class="text-muted-foreground mt-1">Review and manage user registration requests</p>
    </div>
    <div class="flex items-center gap-3">
      @if (store.pendingCount() > 0) {
        <p-tag [value]="store.pendingCount() + ' pending'" severity="info" />
      }
      <button
        pButton
        [disabled]="store.isLoading()"
        (click)="onRefresh()"
        class="p-button-outlined"
        pTooltip="Refresh list"
        tooltipPosition="bottom">
        @if (store.isLoading()) {
          <i class="pi pi-spin pi-spinner"></i>
        } @else {
          <lucide-icon [img]="refreshIcon" class="h-4 w-4"></lucide-icon>
        }
      </button>
    </div>
  </div>
  <p-tabs [value]="store.activeTab()" (valueChange)="onTabChange($any($event))" class="rounded-md">
    <p-tablist>
      @for (tab of tabs; track tab.id) {
        <p-tab [value]="tab.id" class="flex items-center gap-2">
          <lucide-icon [img]="tab.icon" class="h-4 w-4"></lucide-icon>
          <span>{{ tab.label }}</span>
          <app-request-tab-badge [status]="tab.id" [count]="getTabCount(tab.id)" [isLoading]="store.countsLoading()" />
        </p-tab>
      }
    </p-tablist>
    <p-tabpanels>
      @for (tab of tabs; track tab.id) {
        <p-tabpanel [value]="tab.id">
          <div class="card overflow-hidden !p-0">
            @if (store.isLoading() && store.currentRequests().length === 0) {
              <app-requests-skeleton />
            } @else if (store.currentRequests().length === 0) {
              <app-requests-empty-state [activeTab]="store.activeTab()" />
            } @else {
              <app-request-table
                [requests]="store.currentRequests()"
                [activeTab]="store.activeTab()"
                [processingIds]="store.processingIds()"
                (approve)="onApprove($event)"
                (reject)="onReject($event)" />
            }
          </div>
        </p-tabpanel>
      }
    </p-tabpanels>
  </p-tabs>
</div>
